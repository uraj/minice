模拟器流水线设计

整体结构
minisim模拟的是经典的五级流水线，模拟粒度介于指令级和信号级之间。流水线的五个流水级为取值（IF），译码（ID），执行（EX），访存（MEM），回写（WB）。真实的处理器在工作时，流水线的各个流水级是并行运作的。但是软件要做到真实的并发比较困难。在我们的设计中，对各个流水级的模拟是按照从回写到取值的顺序依次执行的。模拟器最上层的执行过程可表示如下：
while(1)
{
    WB;
    MEM;
    EX;
    ID;
	if(stalling)
    {
        gen-bubble;
        continue;
    }
    IF;
    if(sim-end)
        break;
}

IF

ID
ID阶段是五个流水级中最复杂的阶段，需要完成的工作较多。主要有以下几项
  指令译码
对指令进行译码，根据指令信息产生相关的控制信号（在程序中就是为与控制有关的变量赋相应的值）。
  产生操作数
  EX阶段所需要的两个操作数也在ID阶段产生，所以需要完成读寄存器堆、对寄存器中的值进行移位等工作。这之中伴随着数据冒险的检测和解决。
     数据冒险的解决
解决数据冒险的两种手段：加载互锁，数据前递







     移位操作
  EX阶段需要的第二操作数一般并不是某个寄存器中的数据本身，而是需要对其进行某种移位操作。在这过程中还需要根据移位情况对CMSR的C位进行设置。
